<p>@Time        :    2020/2/29 0029 14:47</p>
<p>@Author      :    tb_youth</p>
<p>@FileName    :    pyqt5导入表格数据缓慢及数据同步.md</p>
<p>@Description :    workLog</p>
<p>@Blog        :    https://blog.csdn.net/tb_youth</p>

# pyqt5导入表格数据缓慢及数据同步

------

<p>@Daily English</p>

> ...

> ...

## 问题描述：
使用Pyqt5框架开发,关于TableView。
从本地导入表格数据，如果表格数据很大，存在使用普通的方法导入速度缓慢的问题；
导入数据后，数据如果要进行预处理，需要使用到数据的地方数据存在数据同步（数据一致）的问题。

## 解决想法

### 想法1.0

#### 1.同步更新
可以将导入的数据映射到一个二维表上，修改的时候同步更新二维表中的数据。
这个二维表的数据传递到需要用的地方。
+ 优点：
容易想到。

+ 缺点：
实现起来比较复杂，首先如果读取的是DataFrame格式，需要转换成二维list，
然后是数据传递过程可能要写自定义信号和槽，感觉比较low。

#### 2.导入加速
使用append，一行一行设置Model数据。
+ 优点：
不会多生成空白表格，省内存。

+ 缺点：
小数据表格导入后显示不美观。

结果： 想法1.0已经实现

### 想法2.0

发现从数据库中取数据能够提高IO性能，
pyqt5也有内置方法，将数据库中的数据生成特定的Model，
使用小巧开箱即用的sqlite充当表格存储媒介。

具体做法：
创建一个存临时数据的数据库，这里假设是temp_tb.db。

+ 关于使用不频繁的数据（非用户自己上传的）：
本地打开多表格，打开的时候，自动导入temp_tb.db,
然后从temp_tb.db获取该表格数据显示到TableView，
+ 关于请理temp_tb.db中的临时数据：
不需要频繁去清理，可以设置表格数量达到20-50时（用专门的一张表格来存储临时表格
的记录）来清理。
这个操作放在导入表格时，只需要查询一下temp_tb.db是否达到预设值，如果达到了，
就先请理一下，同时重新创建存储表格记录的表。

+ 关于使用频繁的数据：
建议用户手动上传到数据库（非temp_tb.db），
对于用户上传的数据放到其他数据库，
可以有一个默认的数据库(假设为default_tb.db)，
也可以用户自己创建这些媒介数据库（个性化）。

+ 优点：
Pyqt5提供了数据库接口，容易实现，
对于数据同步，能够很完美，很优秀的解决，
导入数据性能也可以大幅度提升。

+ 缺点：
小数据表格导入后显示不美观。（解决思路和想法1.0一致）
增删操作需要注意。

结果：
想法2.0 正在实现。

